--- 
title_meta  : Chapter 4
title       : Application to Expression Data
description : "In this chapter, you will combine what you learned in the first three chapters to read in, tidy, and visualize gene expression data. Let's get started!"

--- type:NormalExercise key:2200ac0aae
## Putting it all together

Now that you've learned how to work with R, use `tidyr`/`dplyr` and `ggplot2` you will apply these skills to read in and visualize gene expression data.

We will read expression data for study [GSE55268](http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE55278). This study describes expression profiling of dendritic cells after infection with multiple strains of influenza viruses over an 8-hour time course. Read the abstract of [the associated publication](http://www.ncbi.nlm.nih.gov/pubmed/26223639) before continuing.

*** =instructions
- Hit 'Submit Answer' to continue

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
```

*** =solution
```{r}
```

*** =sct
```{r}
success_msg("Now that you understand the study, let's analyze some data!")
```

--- type:NormalExercise  key:ecc45725c8
## Reading in the data
To get microarray data, you'll use a package called `GEOquery` from Bioconductor to read in the data.

--- type:NormalExercise  key:483c4c5eb5
## ExpressionSet Objects

The data we just read in is stored in an object of the `ExpressionSet` class.  You can think of an `ExpressionSet` class as a container designed to combine multiple sources of information from a gene expression experiment into a single object. If interested, you can read more about this class [here](https://www.bioconductor.org/packages/devel/bioc/vignettes/Biobase/inst/doc/ExpressionSetIntroduction.pdf).

For this course, you need to know three functions to extract data from an `ExpressionSet`

- `pData`: Retreive information on experimental phenotypes (e.g. geo\_accession, Condition, Time)
- `fData`: Retrieve information on features (e.g. Entrez\_Gene\_ID, Symbol, Species)
- `exprs`: Retrieve expression data matrix

*** =instructions
- Print `eset` to get an overview of the expression data it contains.
- Create a new variable (`expr`) that contains the expression data from `eset`
- Create a new variable (`features`) that contains the feature data from `eset`
- Create a new variable (`phenotypes`) that contains the phenotype data from `eset`
- Click 'Submit Answer'.

*** =hint
Remember that if you want to assign values to a variable in R, you can make use of the assignment operator `<-`. Use the functions listed above to extract data from `eset`.

*** =pre_exercise_code
```{r}
load(url("http://s3.amazonaws.com/assets.datacamp.com/production/course_1843/datasets/eset.RData"))
```

*** =sample_code
```{r}
# Print eset

# Extract information out of eset into 3 new variables

```

*** =solution
```{r}
# Print eset
print(eset)

# Extract information out of eset into 3 new variables
expr <- exprs(eset)                     # expression data
fdat <- fData(eset)
pdat <- pData(eset)
```

*** =sct
```{r}
test_object("my_apples", 
            undefined_msg = "Please make sure to define a variable `my_apples`.",
            incorrect_msg = "Make sure that you assign the correct value to `my_apples`.")
test_output_contains(print(eset), incorrect_msg = "Have you printed the `expr` variable?")
test_object("expr",
            undefined_msg = "Please make sure to define a variable `expr`.",
            incorrect_msg = "Have you set the variable `expr`?")
test_object("fdat",
            undefined_msg = "Please make sure to define a variable `fdat`.",
            incorrect_msg = "Have you set the variable `fdat`?")
test_object("pdat",
            undefined_msg = "Please make sure to define a variable `pdat`.",            
            incorrect_msg = "Have you set the variable `pdat`?")
success_msg("Great! Continue to the next exercise!")
```


--- type:NormalExercise  key:e7416248d9
## Tidy the data

--- type:NormalExercise  key:9c603bbce2
## Plotting Gene Expression


--- type:NormalExercise  key:4580ed6614
## Plotting Gene Expression 

--- type:NormalExercise  key:f548bed685
## Plotting Gene Expression (2)

--- type:NormalExercise  key:6a67c9447e
## Plotting Gene Expression (3)

--- type:NormalExercise  key:ae47d50b6a
## Data Interrogation


